# Operating My Aibud - Platform Owner Guide (January 2026)

## ðŸš€ Business Model & Client Journey

1. **Sign Up:** Users register via Clerk (`/sign-up`). Each user is a unique "Tenant".
2. **Connect WhatsApp:** Tenants create instances via the Dashboard or `/instances` and scan QR codes.
3. **AI Automation:** Once connected, the AI handles incoming messages based on Settings.
4. **Campaigns:** Tenants upload Excel/CSV files to send bulk messages.
5. **Credits:** Each tenant has a credit limit (default 400). Credits are deducted for AI processing and outgoing messages.

---

## ðŸ—ï¸ Technical Infrastructure (WAHA Plus + Convex)

### Current Stack
- **Frontend:** Next.js 16 (on Vercel)
- **Database:** Convex (Serverless, Real-time)
- **WhatsApp API:** WAHA Plus (on Hetzner VPS: 49.13.153.22)
- **AI:** Google Gemini 1.5 (Pro/Flash)
- **Background Jobs:** Inngest (Campaigns & AI response queue)

### Server Management (Hetzner)
- Manage via **Coolify** at your VPS IP.
- WAHA Plus runs as a Docker container.
- **Port:** 3000
- **Key:** `myaibud-waha-key-2025`

---

## ðŸ› ï¸ Production Setup (The "Both" Checklist)

### 1. Vercel Environment Variables
Add these to **Vercel Project Settings > Environment Variables**:

| Category | Key | Value |
|----------|-----|-------|
| **WhatsApp** | `WAHA_API_URL` | `http://49.13.153.22:3000` |
| | `WAHA_API_KEY` | `myaibud-waha-key-2025` |
| | `WAHA_WEBHOOK_SECRET` | `my-aibud-waha-webhook-secret` |
| | `WHATSAPP_PROVIDER` | `waha` |
| **AI** | `GOOGLE_GENERATIVE_AI_API_KEY` | `AIzaSy...` (Your Gemini Key) |
| **Convex** | `NEXT_PUBLIC_CONVEX_URL` | `https://optimistic-ermine-644.convex.cloud` |
| | `CONVEX_DEPLOYMENT` | `dev:optimistic-ermine-644` |
| **Clerk** | `NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY` | `pk_test_...` |
| | `CLERK_SECRET_KEY` | `sk_test_...` |
| **Inngest** | `INNGEST_EVENT_KEY` | `7E5s...` |
| | `INNGEST_SIGNING_KEY` | `signkey-...` |

### 2. Webhook Configuration (WAHA Plus)
Configure the global webhook in your WAHA instance:
- **Webhook URL:** `https://your-app.vercel.app/api/webhooks/whatsapp`
- **Events:** `message`, `session.status`, `message.any`
- **Secret:** `my-aibud-waha-webhook-secret`

---

## ðŸ“ˆ Capacity & Scaling

- **Current VPS (Hetzner):** Can handle ~10-20 concurrent WhatsApp instances.
- **Scaling Up:** Add more Hetzner nodes and use a load balancer if reaching >50 clients.
- **Database:** Convex auto-scales; you only pay for usage beyond free tier.
- **AI Cost:** Gemini Flash is extremely cheap (~$0.10 per 1M tokens).

---

## ðŸ”§ Maintenance

1. **Redeploying:** Any change pushed to GitHub scales to Vercel automatically.
2. **Convex Changes:** Run `npx convex deploy` if you modify schema or backend functions.
3. **Logs:** Check Vercel Logs for API errors and Inngest for job failures.